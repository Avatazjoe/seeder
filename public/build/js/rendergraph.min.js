/*
 Seeder 2014-04-30 
*/
function shadeColor(a,b){var c=parseInt(a.substring(1,3),16),d=parseInt(a.substring(3,5),16),e=parseInt(a.substring(5,7),16);c=parseInt(c*(100+b)/100),d=parseInt(d*(100+b)/100),e=parseInt(e*(100+b)/100),c=255>c?c:255,d=255>d?d:255,e=255>e?e:255;var f=1==c.toString(16).length?"0"+c.toString(16):c.toString(16),g=1==d.toString(16).length?"0"+d.toString(16):d.toString(16),h=1==e.toString(16).length?"0"+e.toString(16):e.toString(16);return"#"+f+g+h}var Renderer=function(a){var b,a=$(a).get(0),c=a.getContext("2d"),d={init:function(c){b=c,b.screenSize(a.width,a.height),b.screenPadding(0),d.initMouseHandling()},redraw:function(){c.fillStyle="white",c.fillRect(0,0,a.width,a.height),b.eachEdge(function(a,b,d){c.strokeStyle="rgba(0,0,0, 1.0)",c.lineWidth=2,c.beginPath(),c.moveTo(b.x,b.y),c.lineTo(d.x,d.y),c.stroke()}),b.eachNode(function(a,b){var d=70,e=d/2;if("ARTICLE"==a.data.TYPE)if(void 0!=a.data.imagedata){a.data.imagedata.width=d+"px",a.data.imagedata.height=d+"px",c.beginPath(),c.save(),c.beginPath(),c.arc(b.x,b.y,e,0,2*Math.PI,!1),c.lineWidth=5,c.strokeStyle="#003300",c.shadowColor="#000",c.shadowBlur=16,c.shadowOffsetX=0,c.shadowOffsetY=0,c.stroke(),c.clip();try{c.drawImage(a.data.imagedata,b.x-d/2,b.y-d/2,d,d)}catch(f){}c.restore(),c.font="10pt Arial",c.fillStyle="black",c.fillText(a.data.TITLE,b.x+d/2+3,b.y+3)}else c.beginPath(),c.arc(b.x,b.y,a.data.size,0,2*Math.PI,!1),c.fillStyle=a.data.color,c.shadowColor="#000",c.shadowBlur=16,c.shadowOffsetX=0,c.shadowOffsetY=0,c.fill(),c.lineWidth=3,c.strokeStyle=shadeColor(a.data.color,-20),c.stroke(),c.font="12pt Arial",c.fillStyle="black",c.fillText(a.data.name,b.x-4,b.y+3);if("TEXT"==a.data.TYPE){var e=a.data.size;c.beginPath(),c.arc(b.x,b.y,e,0,2*Math.PI,!1),c.fillStyle=a.data.color,c.shadowColor="rgba(0, 0, 0, 0.5)",c.shadowBlur=10,c.shadowOffsetX=0,c.shadowOffsetY=0,c.fill(),c.lineWidth=3,c.strokeStyle=shadeColor(a.data.color,-20),c.stroke(),c.font="12pt Arial",c.fillStyle="rgba(0, 0, 0, 0.6)",c.fillRect(b.x-10,b.y+10,c.measureText(a.data.name).width+10,-25),c.fillStyle="white",c.fillText(a.data.name,b.x-4,b.y+3)}if("LAYER"==a.data.TYPE){var e=a.data.size;c.beginPath(),c.arc(b.x,b.y,e,0,2*Math.PI,!1),c.fillStyle=a.data.color,c.fill(),c.lineWidth=8,c.strokeStyle=shadeColor(a.data.color,-20),c.stroke(),c.font="12pt Arial",c.fillStyle="rgba(0, 0, 0, 0.6)",c.fillRect(b.x-10,b.y+10,c.measureText(a.data.name).width+10,-25),c.fillStyle="white",c.fillText(a.data.name,b.x-4,b.y+3)}})},initMouseHandling:function(){var c=null,d={clicked:function(e){var f=$(a).offset();return _mouseP=arbor.Point(e.pageX-f.left,e.pageY-f.top),c=b.nearest(_mouseP),c&&null!==c.node&&(c.node.fixed=!0),$(a).bind("mousemove",d.dragged),$(window).bind("mouseup",d.dropped),!1},dragged:function(d){var e=$(a).offset(),f=arbor.Point(d.pageX-e.left,d.pageY-e.top);if(c&&null!==c.node){var g=b.fromScreen(f);c.node.p=g}return!1},dropped:function(){return null!==c&&void 0!==c.node?(null!==c.node&&(c.node.fixed=!1),c.node.tempMass=1e3,c=null,$(a).unbind("mousemove",d.dragged),$(window).unbind("mouseup",d.dropped),_mouseP=null,!1):void 0}};$(a).mousedown(d.clicked)}};return d};